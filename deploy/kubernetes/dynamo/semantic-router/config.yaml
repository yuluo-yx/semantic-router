# Semantic Router configuration for Dynamo E2E Testing
# Simplified config without LoRA complexity - focuses on testing Dynamo load balancing/batching

model_config:
  "TinyLlama/TinyLlama-1.1B-Chat-v1.0": {}  # No reasoning family needed - let Dynamo handle load balancing

# Simplified categories for E2E testing
# All route to TinyLlama/TinyLlama-1.1B-Chat-v1.0 (the model configured in Dynamo workers)
categories:
  - name: math
    system_prompt: "You are a mathematics expert. Provide step-by-step solutions."
    model_scores:
      - model: TinyLlama/TinyLlama-1.1B-Chat-v1.0
        score: 1.0
        use_reasoning: false

  - name: science
    system_prompt: "You are a science expert covering biology, chemistry, and physics."
    model_scores:
      - model: TinyLlama/TinyLlama-1.1B-Chat-v1.0
        score: 0.9
        use_reasoning: false

  - name: general
    system_prompt: "You are a helpful assistant."
    model_scores:
      - model: TinyLlama/TinyLlama-1.1B-Chat-v1.0
        score: 0.7
        use_reasoning: false

  - name: other
    system_prompt: "You are a helpful assistant for general queries."
    model_scores:
      - model: TinyLlama/TinyLlama-1.1B-Chat-v1.0
        score: 0.6
        use_reasoning: false

default_model: TinyLlama/TinyLlama-1.1B-Chat-v1.0

# Classifier configuration
bert_model:
  model_id: models/all-MiniLM-L12-v2
  threshold: 0.6
  use_cpu: true

classifier:
  category_model:
    model_id: "models/category_classifier_modernbert-base_model"
    use_modernbert: true
    threshold: 0.6
    use_cpu: true
    category_mapping_path: "models/category_classifier_modernbert-base_model/category_mapping.json"
  pii_model:
    model_id: "models/pii_classifier_modernbert-base_presidio_token_model"
    use_modernbert: true
    threshold: 0.7
    use_cpu: true
    pii_mapping_path: "models/pii_classifier_modernbert-base_presidio_token_model/pii_type_mapping.json"

# Semantic cache for performance testing
semantic_cache:
  enabled: true
  backend_type: "memory"
  similarity_threshold: 0.8
  max_entries: 1000
  ttl_seconds: 3600
  eviction_policy: "fifo"
  use_hnsw: true
  hnsw_m: 16
  hnsw_ef_construction: 200
  embedding_model: "bert"

# Tools configuration
tools:
  enabled: true
  top_k: 3
  similarity_threshold: 0.2
  tools_db_path: "config/tools_db.json"
  fallback_to_empty: true

# Prompt guard
prompt_guard:
  enabled: true
  use_modernbert: true
  model_id: "models/jailbreak_classifier_modernbert-base_model"
  threshold: 0.7
  use_cpu: true
  jailbreak_mapping_path: "models/jailbreak_classifier_modernbert-base_model/jailbreak_type_mapping.json"

# Router configuration
router:
  high_confidence_threshold: 0.99
  low_latency_threshold_ms: 2000

# Embedding models
embedding_models:
  qwen3_model_path: "models/Qwen3-Embedding-0.6B"
  gemma_model_path: "models/embeddinggemma-300m"
  use_cpu: true

# API Configuration
api:
  batch_classification:
    max_batch_size: 100
    concurrency_threshold: 5
    max_concurrency: 8

# Observability (disabled for E2E)
observability:
  tracing:
    enabled: false
